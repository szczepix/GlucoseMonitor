<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="GlucoseMonitor.UI.UpdateWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:GlucoseMonitor.UI"
    Title="Version Manager - GlucoseMonitor">

    <Grid Background="#FF1a1a1a" Padding="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,16">
            <TextBlock Text="Version Manager" FontSize="24" FontWeight="Bold" Foreground="White"/>
            <TextBlock x:Name="CurrentVersionText" Text="Current: v1.0.0" Foreground="Gray" Margin="0,4,0,0"/>
        </StackPanel>

        <!-- Filter toolbar -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,12" Spacing="16">
            <CheckBox x:Name="ShowPreReleasesCheck"
                      Content="Show pre-releases"
                      Foreground="White"
                      IsChecked="False"
                      Checked="ShowPreReleases_Changed"
                      Unchecked="ShowPreReleases_Changed"/>
            <Button x:Name="RefreshBtn" Content="Refresh" Click="Refresh_Click"
                    Background="#FF2d2d2d" Foreground="White"/>
            <ProgressRing x:Name="LoadingRing" IsActive="False" Width="20" Height="20"/>
        </StackPanel>

        <!-- Version list -->
        <Border Grid.Row="2" Background="#FF2d2d2d" CornerRadius="8" Padding="4">
            <ListView x:Name="VersionList"
                      SelectionChanged="VersionList_SelectionChanged"
                      Background="Transparent">
                <ListView.ItemContainerStyle>
                    <Style TargetType="ListViewItem">
                        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                        <Setter Property="Padding" Value="8"/>
                        <Setter Property="Margin" Value="2"/>
                    </Style>
                </ListView.ItemContainerStyle>
            </ListView>
        </Border>

        <!-- Release details panel -->
        <Border Grid.Row="3" Background="#FF2d2d2d" CornerRadius="8" Padding="12" Margin="0,12,0,0">
            <StackPanel>
                <TextBlock Text="Release Notes" FontWeight="SemiBold" Foreground="White" Margin="0,0,0,8"/>
                <ScrollViewer MaxHeight="120" VerticalScrollBarVisibility="Auto">
                    <TextBlock x:Name="ReleaseNotesText"
                               TextWrapping="Wrap"
                               Foreground="LightGray"
                               Text="Select a version to view release notes"/>
                </ScrollViewer>
                <StackPanel Orientation="Horizontal" Margin="0,8,0,0" Spacing="16">
                    <TextBlock x:Name="FileSizeText" Text="Size: --" Foreground="Gray"/>
                    <TextBlock x:Name="PublishedDateText" Text="Published: --" Foreground="Gray"/>
                </StackPanel>
            </StackPanel>
        </Border>

        <!-- Progress bar -->
        <StackPanel Grid.Row="4" x:Name="ProgressPanel" Visibility="Collapsed" Margin="0,12,0,0">
            <ProgressBar x:Name="DownloadProgress" Maximum="100" Value="0" Height="8"/>
            <StackPanel Orientation="Horizontal" Margin="0,4,0,0" HorizontalAlignment="Center" Spacing="8">
                <TextBlock x:Name="ProgressText" Text="Downloading..." Foreground="White"/>
                <TextBlock x:Name="ProgressPercent" Text="0%" Foreground="LimeGreen"/>
            </StackPanel>
        </StackPanel>

        <!-- Action buttons -->
        <StackPanel Grid.Row="5" Orientation="Horizontal" HorizontalAlignment="Right" Spacing="8" Margin="0,16,0,0">
            <Button x:Name="SkipBtn" Content="Skip This Version" Click="Skip_Click"
                    Background="#FF2d2d2d" Foreground="White" IsEnabled="False"/>
            <Button x:Name="DownloadBtn" Content="Download &amp; Install" Click="DownloadInstall_Click"
                    Background="#FF0078D4" Foreground="White" IsEnabled="False"/>
            <Button x:Name="CancelBtn" Content="Close" Click="Cancel_Click"
                    Background="#FF2d2d2d" Foreground="White"/>
        </StackPanel>
    </Grid>
</Window>
